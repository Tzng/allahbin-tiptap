"use strict";(self.webpackChunk_allahbin_tiptap=self.webpackChunk_allahbin_tiptap||[]).push([[433],{37501:function(Ke,q,d){d.r(q),d.d(q,{default:function(){return ze}});var yt=d(48305),R=d.n(yt),Ct=d(26068),L=d.n(Ct),bt=d(67825),_=d.n(bt),At=d(90228),tt=d.n(At),Tt=d(87999),kt=d.n(Tt),C=d(50959),Ve=d(45033),Ue=d(76836),E=d(52063),jt=E.NB.create({name:"ATail",addOptions:function(){return{HTMLAttributes:{class:"a-tiptap-tail"}}},content:"inline*",group:"block",defining:!0,parseHTML:function(){return[{tag:"div.a-tiptap-tail",getAttrs:function(e){return{class:"a-tiptap-tail"}}}]},renderHTML:function(t){var e=t.node,a=t.HTMLAttributes,n=L()(L()({},a),{},{class:"a-tiptap-tail"});return["div",n,0]},addCommands:function(){var t=this;return{setATail:function(){return function(a){var n=a.commands;return n.setNode(t.name,{})}},toggleATail:function(){return function(a){var n=a.commands;return n.toggleNode(t.name,"paragraph",{})}}}},addInputRules:function(){return[(0,E.zK)({find:/^!-\s$/,type:this.type,getAttributes:function(){return{class:"a-tiptap-tail"}}})]}}),St=E.NB.create({name:"ATitle",addOptions:function(){return{levels:[1,2,3],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes:function(){return{level:{default:1,rendered:!1}}},parseHTML:function(){return console.log("parseHTML"),this.options.levels.map(function(t){return{tag:"div.a-tiptap-title".concat(t),attrs:{level:t,class:"a-tiptap-title".concat(t)}}})},renderHTML:function(t){var e=t.node,a=t.HTMLAttributes;console.log("renderHTML");var n=this.options.levels.includes(e.attrs.level),s=n?e.attrs.level:this.options.levels[0];return["div",(0,E.P1)(this.options.HTMLAttributes,a,{class:"a-tiptap-title".concat(s)}),0]},addCommands:function(){var t=this;return{setATitle:function(a){return function(n){var s=n.commands;return console.log("setHeading"),t.options.levels.includes(a.level)?s.setNode(t.name,a):!1}},toggleATitle:function(a){return function(n){var s=n.commands;return console.log("toggleATitle"),t.options.levels.includes(a.level)?s.toggleNode(t.name,"paragraph",a):!1}}}},addInputRules:function(){var t=this;return this.options.levels.map(function(e){return(0,E.zK)({find:new RegExp("^(!{1,".concat(e,"})\\s$")),type:t.type,getAttributes:{level:e,class:"a-tiptap-title".concat(e)}})})}}),Mt=E.NB.create({name:"AWenHao",addOptions:function(){return{HTMLAttributes:{class:"a-tiptap-wenhao"}}},content:"inline*",group:"block",defining:!0,parseHTML:function(){return[{tag:"div.a-tiptap-wenhao",getAttrs:function(e){return{class:"a-tiptap-wenhao"}}}]},renderHTML:function(t){var e=t.node,a=t.HTMLAttributes;console.log("renderHTML");var n=L()(L()({},a),{},{class:"a-tiptap-wenhao"});return["div",n,0]},addCommands:function(){var t=this;return{setWenHao:function(){return function(a){var n=a.commands;return n.setNode(t.name,{})}},toggleWenHao:function(){return function(a){var n=a.commands;return n.toggleNode(t.name,"paragraph",{})}}}},addInputRules:function(){return[(0,E.zK)({find:/^!~\s$/,type:this.type,getAttributes:function(){return{class:"a-tiptap-wenhao"}}})]}}),I=d(68923),et=d(14842),nt=d(63063),at=d(96063),Lt=d(51823),Et=d(83608),Ht=d(86520),Nt=d(37176),Rt=d(13067),Ot=d(83356),U=d(62023),it=d(36009),st=d(25514),Bt=d(22623),It=d(6734),Pt=d(99288),$t=d(35260),Ft=d(68457),Dt=d(67737),Wt=d(83113),zt=d(62308),wt=d(76753),Kt=d(86674),Vt=d(97517),Ut=d(67223),Jt=d(74972),rt=d(5283),Gt=d(71392),Xt=d(15558),G=d.n(Xt),Yt=d(83994),K=d(3317),Zt=E.hj.create({name:"markdownClipboardCopy",addProseMirrorPlugins:function(){var t=this;return[new K.Sy({key:new K.H$("markdownClipboardCopy"),props:{clipboardTextSerializer:function(a){var n,s,r=t.editor.schema.topNodeType.createAndFill(void 0,a.content);return r&&((n=t.editor.storage.markdown)===null||n===void 0||(s=n.getMarkdown)===null||s===void 0?void 0:s.call(n,r))||""}}})]}}),ot=d(83578),Qt=d(335),D=d.n(Qt),qt=function(t){return t.schema.nodes.codeBlock&&(0,E.Ig)(t,"codeBlock")||t.schema.marks.code&&(0,E.yw)(t,"code")},_t=function(t){var e=t.match(/^```/gm);if(e&&e.length>1||t.match(/\[[^]+]\(https?:\/\/\S+\)/gm)||t.match(/\[[^]+]\(\/\S+\)/gm)||t.match(/^#{1,6}\s+\S+/gm)||t.match(/^!{1,3}\s+\S+/gm)||t.match(/^!-\s+\S+$/gm)||t.match(/^!~\s+\S+$/gm))return!0;var a=t.match(/^\s*[\d-*]\s+\S+/gm);if(a&&a.length>1)return!0;var n=t.match(/^\s*[-*]\s\[[ xX]\]\s+\S+/gm);return!!(n&&n.length>1||t.match(/^>\s+\S+/gm)||t.match(/^---/gm)||t.match(/^!\[[^]+]\(https?:\/\/\S+\)/gm)||t.match(/^\|.*\|$/gm)||t.match(/\*\*[^]+?\*\*/gm)||t.match(/_[^]+?_/gm)||t.match(/~~[^]+?~~/gm)||t.match(/`[^]+?`/gm))},te=function(t){var e=/<div class="a-tiptap-title(\d)">([\s\S]*?)<\/div>/g,a=t.matchAll(e),n=t,s=D()(a),r;try{for(s.s();!(r=s.n()).done;){var i=r.value,f=parseInt(i[1]),l=i[2].trim(),c="".concat("!".repeat(f)," ").concat(l);n=n.replace(i[0],c)}}catch(h){s.e(h)}finally{s.f()}return n},ee=function(t){var e=/<div class="a-tiptap-wenhao">([\s\S]*?)<\/div>/g,a=t.matchAll(e),n=t,s=D()(a),r;try{for(s.s();!(r=s.n()).done;){var i=r.value,f=i[1].trim().length,l=i[1].trim(),c="".concat("!~".repeat(f>1?1:f)," ").concat(l);n=n.replace(i[0],c)}}catch(h){s.e(h)}finally{s.f()}return n},ne=function(t){var e=/<div class="a-tiptap-tail">([\s\S]*?)<\/div>/g,a=t.matchAll(e),n=t,s=D()(a),r;try{for(s.s();!(r=s.n()).done;){var i=r.value,f=i[1].trim(),l="!- ".concat(f);n=n.replace(i[0],l)}}catch(c){s.e(c)}finally{s.f()}return n},lt=function(t){var e=/^!-\s+(.*)$/gm,a=t.matchAll(e),n=t,s=D()(a),r;try{for(s.s();!(r=s.n()).done;){var i=r.value,f=i[1].trim(),l='<div class="a-tiptap-tail">'.concat(f,"</div>");n=n.replace(i[0],l)}}catch(c){s.e(c)}finally{s.f()}return n},dt=function(t){var e=/^!~\s+(.*)$/gm,a=t.matchAll(e),n=t,s=D()(a),r;try{for(s.s();!(r=s.n()).done;){var i=r.value,f=i[1].trim(),l='<div class="a-tiptap-wenhao">'.concat(f,"</div>");n=n.replace(i[0],l)}}catch(c){s.e(c)}finally{s.f()}return n},ut=function(t){var e=/^(!{1,3})\s+(.*)$/gm,a=t,n=t.matchAll(e),s=D()(n),r;try{for(s.s();!(r=s.n()).done;){var i=r.value,f=i[1],l=f.length,c=i[2].trim(),h='<div class="a-tiptap-title'.concat(l,'">').concat(c,"</div>");a=a.replace(i[0],h)}}catch(p){s.e(p)}finally{s.f()}return a},ae=E.hj.create({name:"markdownClipboardPaste",priority:50,addProseMirrorPlugins:function(){var t=this;return[new K.Sy({key:new K.H$("markdownClipboardPaste"),props:{handlePaste:function(a,n){var s=t.editor.isEditable,r=n.clipboardData;if(!s||!r||r.files.length!==0)return!1;var i=r.getData("text/plain"),f=r.getData("text/html");if(f.length>0)return!1;if(qt(a.state))return n.preventDefault(),a.dispatch(a.state.tr.insertText(i)),!0;if(_t(i)){var l,c,h=lt(i);h=dt(h),h=ut(h);var p=(l=t.editor.storage.markdown)===null||l===void 0||(l=l.parser)===null||l===void 0||(c=l.parse)===null||c===void 0?void 0:c.call(l,h,{inline:!1});if(console.log("html",p),!p||typeof p!="string")return!1;var x=ot.aw.fromSchema(t.editor.schema),T=(0,E.q_)(p),y=x.parse(T,{});console.log("node",y);var k=y.content,m=a.state.selection.content();return a.dispatch(a.state.tr.replaceSelection(new ot.p2(k,m.openStart,m.openEnd))),!0}return!1}}})]}}),ie=Yt.U.extend({name:"markdown",priority:50,addOptions:function(){var t;return L()(L()({},(t=this.parent)===null||t===void 0?void 0:t.call(this)),{},{paste:!0,copy:!0})},onBeforeCreate:function(){var t,e=this;(t=this.parent)===null||t===void 0||t.call(this),this.editor.storage.markdown.getMarkdown=function(a){var n=e.editor.storage.markdown.serializer.serialize(a!=null?a:e.editor.state.doc);return n=te(n),n=ee(n),n=ne(n),n}},addExtensions:function(){return[].concat(G()(this.options.copy?[Zt]:[]),G()(this.options.paste?[ae]:[]))},onCreate:function(){this.editor.options.content=this.editor.options.initialContent,delete this.editor.options.initialContent}}),se=d(88698),re=E.hj.create({name:"starterKit",addExtensions:function(){var t=[],e=[];if(this.options.commands!==!1&&t.push(I.Gh),this.options.highPriorityKeymap!==!1&&t.push(I.Yg),this.options.lowPriorityKeymap!==!1&&t.push(I.vR),this.options.document!==!1&&t.push(et.B),this.options.paragraph!==!1&&(t.push(nt.n.configure(this.options.paragraph)),e.push("paragraph")),this.options.text!==!1&&t.push(at.x),this.options.textAlign!==!1&&t.push(Lt.P.configure(L()({types:["heading","paragraph"]},this.options.textAlign))),this.options.bold!==!1&&t.push(wt.d8.configure(this.options.bold)),this.options.italic!==!1&&t.push(Kt.Tx.configure(this.options.italic)),this.options.strike!==!1&&t.push(Vt.Re.configure(this.options.strike)),this.options.code!==!1&&t.push(Ut.EK.configure(this.options.code)),this.options.link!==!1&&t.push(it.rU.configure(this.options.link)),this.options.heading!==!1&&(t.push(Et.X.configure(this.options.heading)),e.push("heading")),this.options.blockquote!==!1&&(t.push(zt.V6.configure(this.options.blockquote)),e.push("blockquote")),this.options.hardBreak!==!1&&t.push(Ht.U.configure(this.options.hardBreak)),this.options.horizontalRule!==!1&&(t.push(Gt.b.configure(this.options.horizontalRule)),e.push("horizontalRule")),this.options.listsIndentation!==!1&&t.push(It.R_.configure(this.options.listsIndentation)),this.options.indentation!==!1&&t.push(Bt.I.configure(this.options.indentation)),this.options.bulletList!==!1&&t.push(Pt.D.configure(this.options.bulletList)),this.options.orderedList!==!1&&t.push($t.G.configure(this.options.orderedList)),(this.options.bulletList!==!1||this.options.orderedList!==!1)&&t.push(Ft.H.configure(this.options.listItem)),this.options.taskList!==!1&&(t.push(Dt.a.configure(this.options.taskList)),t.push(Wt.Uf.configure(this.options.taskItem))),(this.options.bulletList!==!1||this.options.orderedList!==!1||this.options.taskList!==!1)&&e.push("list"),this.options.codeBlock!==!1&&(t.push(Jt.dn.configure(this.options.codeBlock)),e.push("codeBlock")),this.options.image!==!1&&(this.options.uploader!==!1?(t.push(st.Ee.configure(this.options.image)),e.push("image")):console.warn("Uploader extension is required for image extension. Please enable uploader extension.")),this.options.table!==!1){var a=U.pj.extend({content:"(".concat(e.join(" | "),")+")});t.push(U.iA.configure(this.options.table)),t.push(U.SC.configure(this.options.tableRow)),t.push(a.configure(this.options.tableCell))}return this.options.emoji!==!1&&t.push(rt.dy.configure(L()({enableEmoticons:!0,forceFallbackImages:!1,suggestion:rt.Jz},this.options.emoji))),this.options.history!==!1&&t.push(Nt.A.configure(this.options.history)),this.options.dropcursor!==!1&&t.push(Rt.m.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(Ot.f),this.options.uploader!==!1&&t.push(se.Qm.configure(this.options.uploader)),this.options.markdown!==!1&&t.push(ie.configure(L()({linkify:!0,breaks:!0,tightLists:!0,paste:!0,copy:!1},this.options.markdown))),t}}),Je=null,ct=d(35605),v=d(24692),o=d(11527),oe=function(t){var e=t.className,a=t.style,n=t.title,s=(0,v.W6)(function(){return{isActive:function(){return(0,I.zh)(r.state,"link")},disabled:function(){return!r.state.schema.marks.link||!r.can().chain().focus().toggleMark("link").run()}}}),r=s.editor,i=s.statusMap;return(0,o.jsx)(v.o1,{className:e,style:a,children:(0,o.jsx)(v.u,{text:n||"\u94FE\u63A5 (".concat(v.WD," + K)"),children:(0,o.jsx)(v.zx,{onClick:function(){var l,c;return r==null||(l=(c=r.chain().focus()).toggleLink)===null||l===void 0?void 0:l.call(c,{href:""}).run()},isActive:i==null?void 0:i.isActive,disabled:i==null?void 0:i.disabled,children:(0,o.jsx)(ct.c9z,{})})})})},le=d(78498),V=d(67761),de=function(t){var e=t.text,a=t.href,n=t.onConfirm,s=t.onCancel,r=(0,C.useRef)(null),i=(0,C.useRef)(null),f=(0,C.useState)(e),l=R()(f,2),c=l[0],h=l[1],p=(0,C.useState)(a),x=R()(p,2),T=x[0],y=x[1],k=(0,C.useCallback)(function(){n==null||n({text:c||T,href:T})},[n,c,T]);return(0,C.useEffect)(function(){var m=setTimeout(function(){if(c){if(!T){var A;(A=i.current)===null||A===void 0||A.focus()}}else{var g;(g=r.current)===null||g===void 0||g.focus()}},200);return function(){clearTimeout(m)}},[]),(0,o.jsxs)("div",{className:"tide-editor-popup tide-link-popup",children:[(0,o.jsxs)("div",{className:"tide-link-popup__row",children:[(0,o.jsx)("label",{className:"tide-link-popup__label",children:"\u6587\u672C"}),(0,o.jsx)("input",{className:"tide-link-popup__input",ref:r,value:c,onChange:function(g){return h(g.target.value)}})]}),(0,o.jsxs)("div",{className:"tide-link-popup__row",children:[(0,o.jsx)("label",{className:"tide-link-popup__label",children:"\u94FE\u63A5"}),(0,o.jsx)("input",{className:"tide-link-popup__input",ref:i,value:T,onChange:function(g){return y(g.target.value)},onKeyDown:function(g){g.key==="Enter"&&T&&k()}})]}),(0,o.jsxs)("div",{className:"tide-link-popup__btn-group",children:[(0,o.jsx)("button",{className:"tide-link-popup__button tide-link-popup__button--basic",style:{marginLeft:8},onClick:s,children:"\u53D6\u6D88"}),(0,o.jsx)("button",{className:"tide-link-popup__button tide-link-popup__button--primary",onClick:k,disabled:!T,children:"\u786E\u5B9A"})]})]})},ue=function(t,e){var a=e||{},n=a.dom,s=a.defaultText,r=a.defaultHref,i=t.state,f=t.schema,l=i.selection,c=l.$from,h=l.from,p=l.to,x=l.empty,T=(0,E.TP)(f.marks.link,i.schema),y=(0,I.zh)(i,T.name),k=t.getAttributes(T),m,g;if(!y)m=h,g=p;else{var A;if(x){var H=(0,E.IH)(c,T,k);H&&(A={from:H.from,to:H.to})}else A={from:h,to:p};if(!A)return;m=A.from,g=A.to}var S="",N="";i.doc.nodesBetween(m,g,function(B,M,j,b){var O,w;if(B.isInline){var $=((O=(w=B.type.spec).toText)===null||O===void 0?void 0:O.call(w,{node:B,pos:M,parent:j,index:b}))||B.textContent||"";S+=G()($).slice(Math.max(0,m-M),Math.max(0,g-M)).join("")}}),y?(S=S||i.doc.textBetween(m,g)||"",N=k.href):(S=S||i.doc.textBetween(m,g)||s||"",N=r||""),(0,V.Zr)({editor:t,placement:"bottom-start",componentRender:function(M){return new V.M_(de,{props:{text:S,href:N,onConfirm:function(b){var O;S===b.text?t.chain().setTextSelection({from:m,to:g}).setLink({href:b.href}).run():(t.chain().deleteRange({from:m,to:g}).insertContentAt(m,b.text,{updateSelection:!0}).run(),t.chain().command(function(w){var $=w.tr,Q=Math.min(m,$.selection.from),F=$.selection.to;return $.setSelection(K.Bs.create($.doc,Q,F)),!0}).setLink({href:b.href}).run()),(O=M.instance)===null||O===void 0||O.hide(),t.commands.focus()},onCancel:function(){var b;(b=M.instance)===null||b===void 0||b.hide(),t.commands.focus()}},editor:t})},tippyOptions:{getReferenceClientRect:function(){return n?n.getBoundingClientRect():(0,E.pr)(t.view,m,g)}}})},ce=/(?:^|\s)\[(.+?)]\((.+?)\)\s$/,he=le.rU.extend({inclusive:!1,name:"link",addOptions:function(){var t;return L()(L()({},(t=this.parent)===null||t===void 0?void 0:t.call(this)),{},{openOnClick:!1,linkOnPaste:!1,autolink:!0})},addAttributes:function(){return{href:{default:null,parseHTML:function(e){var a;return"".concat((a=e.getAttribute("href"))!==null&&a!==void 0?a:"")}},target:{default:this.options.HTMLAttributes.target},"data-id":{default:null,parseHTML:function(e){var a;return"".concat((a=e.getAttribute("data-id"))!==null&&a!==void 0?a:"")}}}},parseHTML:function(){return[{tag:'a[href]:not([href *= "javascript:" i]):not([data-type])'}]},addCommands:function(){var t,e=this;return L()(L()({},(t=this.parent)===null||t===void 0?void 0:t.call(this)),{},{toggleLink:function(n){return function(s){var r=s.chain,i=s.editor;return(0,I.zh)(i.state,e.name)?r().unsetLink().run():(ue(e.editor,{defaultHref:n.href}),!0)}}})},addKeyboardShortcuts:function(){var t=this;return{"Mod-k":function(){return t.editor.chain().toggleLink({href:""}).run()}}},addInputRules:function(){return[(0,E.Cf)({find:ce,type:this.type,getAttributes:function(e){var a=R()(e,3),n=a[2];return e.pop(),{href:n}}})]}}),Ge=function(t){var e=t.editor,a=useRef(null),n=useState(""),s=_slicedToArray(n,2),r=s[0],i=s[1],f=useState(""),l=_slicedToArray(f,2),c=l[0],h=l[1],p=useCallback(function(){var y=isActive(e.state,LinkExtension.name);if(y){var k=e.getAttributes(LinkExtension.name);i(k.href||""),h(k.target||"")}else i(""),h("");return y},[e]),x=useCallback(function(){e.chain().blur().focus().run(),showLinkEditPopup(e)},[e]),T=useCallback(function(){var y=e.view.state.selection.empty;if(y){var k=e.getAttributes(LinkExtension.name);e.chain().extendMarkRange(LinkExtension.name,k).unsetLink().run()}else e.chain().unsetLink().run()},[e]);return e.state.schema.marks.link?_jsx(SelectionBubbleMenu,{pluginKey:"linkBubbleMenu",editor:e,shouldShow:p,reference:"mark",referenceMarkType:LinkExtension.name,placement:"bottom-start",children:_jsxs("div",{ref:a,className:"tide-menu-bar tide-menu-bar-bubble",children:[_jsx("span",{className:"tide-menu-bar-bubble__link",children:_jsx("a",{href:r,target:c,rel:"noopener noreferrer nofollow",children:r})}),_jsx("button",{className:"tide-menu-bar__btn tide-menu-bar__item",onClick:x,children:_jsx(IconPenBold,{})}),_jsx("button",{className:"tide-menu-bar__btn tide-menu-bar__item",onClick:T,children:_jsx(IconChainSlashBold,{})})]})}):null},fe=d(25298),ve=d.n(fe),pe=d(17069),me=d.n(pe),ge=d(62657),W=d.n(ge),xe=d(9504),X=d.n(xe),ye=d(38836),Y=d.n(ye),Ce=d(21742),be=d.n(Ce),Ae=d(83136),Te=d.n(Ae),ke=d(82092),z=d.n(ke),je=["readOnlyEmptyView","readOnlyShowMenu","menuEnableUndoRedo","menuEnableFullscreen","fullscreen","onFullscreenChange","onReady","onChange"],Se=function(u){be()(e,u);var t=Te()(e);function e(a){var n;ve()(this,e);var s=a.readOnlyEmptyView,r=a.readOnlyShowMenu,i=r===void 0?!1:r,f=a.menuEnableUndoRedo,l=f===void 0?!0:f,c=a.menuEnableFullscreen,h=c===void 0?!0:c,p=a.fullscreen,x=p===void 0?!1:p,T=a.onFullscreenChange,y=a.onReady,k=a.onChange,m=_()(a,je);return n=t.call(this,L()(L()({extensions:[et.B,nt.n,at.x],editorProps:{attributes:{spellCheck:"false"}}},m),{},{onCreate:function(A){var H,S=A.editor,N=S.state,B=S.view;if(N.plugins.length>0){var M=[],j=[];N.plugins.forEach(function(b){b.key.includes("Suggestion")?j.push(b):M.push(b)}),B.updateState(N.reconfigure({plugins:[].concat(j,M)}))}(H=m.onCreate)===null||H===void 0||H.call(m,A),y==null||y(A.editor)},onUpdate:function(A){var H;(H=m.onUpdate)===null||H===void 0||H.call(m,A),k==null||k(A.editor.getJSON(),A.editor)}})),z()(W()(n),"readOnlyEmptyView",void 0),z()(W()(n),"readOnlyShowMenu",void 0),z()(W()(n),"menuEnableUndoRedo",void 0),z()(W()(n),"menuEnableFullscreen",void 0),z()(W()(n),"fullscreen",void 0),z()(W()(n),"onFullscreenChange",void 0),n.readOnlyEmptyView=s,n.readOnlyShowMenu=i,n.menuEnableUndoRedo=l,n.menuEnableFullscreen=h,n.fullscreen=x,n.onFullscreenChange=T,n}return me()(e,[{key:"setFullscreen",value:function(n){var s;this.fullscreen=n,(s=this.onFullscreenChange)===null||s===void 0||s.call(this,n,this),this.emit("update",{editor:this,transaction:this.state.tr}),n&&this.commands.focus(this.options.autofocus)}},{key:"setContent",value:function(n,s,r){return typeof n=="string"&&(n=dt(n),n=lt(n),n=ut(n)),this.commands.setContent(n,s,r)}},{key:"getMarkdown",value:function(){var n,s;return((n=this.storage.markdown)===null||n===void 0||(s=n.getMarkdown)===null||s===void 0?void 0:s.call(n))||""}},{key:"isReadOnly",get:function(){return!this.isEditable}},{key:"on",value:function(n,s){return X()(Y()(e.prototype),"on",this).call(this,n,s)}},{key:"emit",value:function(n){for(var s,r=arguments.length,i=new Array(r>1?r-1:0),f=1;f<r;f++)i[f-1]=arguments[f];return(s=X()(Y()(e.prototype),"emit",this)).call.apply(s,[this,n].concat(i))}},{key:"off",value:function(n,s){return X()(Y()(e.prototype),"off",this).call(this,n,s)}}]),e}(V.ML),Me=d(82187),P=d.n(Me),ht=function(t){var e=t.editor,a=t.contentClassName,n=t.contentStyle,s=t.children,r=P()("tide-content",a);return e&&e.isEmpty&&e.isReadOnly?(0,o.jsx)("div",{className:r,style:n,children:e.readOnlyEmptyView||null}):(0,o.jsx)(V.kg,{className:r,style:n,editor:e,children:s})};ht.displayName="EditorContent";var ft=(0,C.createContext)(null),vt=function(){var t=(0,C.useContext)(ft);if(t===null)throw new Error("useEditorContext must be used within a EditorContextProvider");return t},Le=function(t){var e=t.editor,a=t.children,n=(0,C.useState)(!!(e!=null&&e.isEditable)),s=R()(n,2),r=s[0],i=s[1],f=(0,C.useState)(!!(e!=null&&e.fullscreen)),l=R()(f,2),c=l[0],h=l[1],p=C.useMemo(function(){return{editable:r,fullscreen:c,setEditable:i,setFullscreen:h,editor:e}},[r,c,e]);return(0,C.useEffect)(function(){if(e){i(!!(e!=null&&e.isEditable)),h(!!(e!=null&&e.fullscreen));var x=function(y){i(y.editor.isEditable),h(y.editor.fullscreen)};return e==null||e.on("update",x),function(){e==null||e.off("update",x)}}},[e]),(0,o.jsx)(ft.Provider,{value:p,children:a})},Ee=function(t){var e=t.style,a=t.className,n=t.children,s=vt(),r=s.fullscreen,i=P()("tide-editor",{"tide-editor--fullscreen":r},a);return(0,o.jsx)("div",{className:i,style:e,children:n})},He=function(t){var e=t.editor,a=t.className,n=t.style,s=t.children;return(0,o.jsx)(Le,{editor:e,children:(0,o.jsx)(Ee,{style:n,className:a,children:s})})},pt=(0,C.forwardRef)(function(u,t){var e=u.disabled,a=u.style,n=u.isActive,s=u.children,r=u.onClick;return(0,o.jsx)("button",{style:a,ref:t,onClick:r,disabled:e,className:P()("tide-menu-bar__btn",{"tide-menu-bar__btn--active":n,"tide-menu-bar__btn--disabled":e}),children:s})});pt.displayName="TextButton";var mt=pt,Ne=function(t){var e=t.className,a=t.style,n=t.title,s=(0,v.W6)(function(){return{isActive:function(){return(0,I.zh)(r.state,"ATail")},disabled:function(){return!r.state.schema.nodes.ATail||!r.can().toggleATail()}}}),r=s.editor,i=s.statusMap;return(0,o.jsx)(v.o1,{className:e,style:a,children:(0,o.jsx)(v.u,{text:"\u843D\u6B3E",children:(0,o.jsx)(mt,{onClick:function(){return r.chain().focus().toggleATail().run()},isActive:i==null?void 0:i.isActive,disabled:i==null?void 0:i.disabled,style:{width:48,justifyContent:"center",display:"flex",alignItems:"center"},children:"\u843D\u6B3E"})})})},Re=d(35182),Z=["ATitle1","ATitle2",1,2,3],gt={ATitle1:"\u5927\u6807\u9898",ATitle2:"\u5C0F\u6807\u9898"},Oe=function(){var t=(0,C.useState)(!1),e=R()(t,2),a=e[0],n=e[1],s=(0,v.W6)(function(){var l={paragraphIsActive:function(){return(0,I.zh)(r.state,"paragraph")},paragraphIsDisabled:function(){return!r.can().setParagraph()}};return Z.forEach(function(c){if(typeof c=="number")l["heading".concat(c,"IsActive")]=function(){return(0,I.zh)(r.state,"heading",{level:c})},l["heading".concat(c,"Disabled")]=function(){var p,x;return!r.state.schema.nodes.heading||!((p=(x=r.can()).toggleHeading)!==null&&p!==void 0&&p.call(x,{level:c}))};else{var h=c.split("").pop();l["".concat(c,"IsActive")]=function(){return(0,I.zh)(r.state,"ATitle",{level:Number(h)})},l["".concat(c,"Disabled")]=function(){var p,x;return!r.state.schema.nodes.heading||!((p=(x=r.can()).toggleATitle)!==null&&p!==void 0&&p.call(x,{level:Number(h)}))}}}),l}),r=s.editor,i=s.statusMap,f=function(){if(i!=null&&i.paragraphIsActive)return"\u6B63\u6587";var c=Z.find(function(h){return typeof h=="number"?i==null?void 0:i["heading".concat(h,"IsActive")]:i==null?void 0:i["".concat(h,"IsActive")]});return typeof c=="number"?"\u6807\u9898 ".concat(c):gt[c]||"\u6B63\u6587"};return(0,o.jsx)(v.o1,{children:(0,o.jsx)(Re.ZP,{placement:"bottom-start",interactive:!0,onClickOutside:function(){return n(!1)},visible:a,content:(0,o.jsx)("div",{className:"tide-dropdown-menu",children:(0,o.jsxs)("div",{className:"tide-dropdown-menu__content",children:[(0,o.jsx)("div",{onClick:function(){if(i!=null&&i.paragraphIsDisabled||!r.can().chain().focus().setParagraph().run())return!1;r.chain().focus().setParagraph().run(),n(!1)},className:P()("tide-dropdown-menu__item",{"tide-dropdown-menu__item--active":i==null?void 0:i.paragraphIsActive,"tide-dropdown-menu__item--disabled":i==null?void 0:i.paragraphIsDisabled}),children:(0,o.jsxs)("div",{className:P()("tide-menu-head-row"),children:[(0,o.jsx)("span",{children:"\u6B63\u6587"}),(0,o.jsx)("span",{className:"tide-menu-head-row__span",children:"".concat(v.WD," + ").concat(v.Kw," + 0")})]})}),Z.map(function(l){return(0,o.jsx)("li",{onClick:function(){if(typeof l=="number"){if(i!=null&&i["heading".concat(l,"Disabled")]||!r.can().chain().focus().toggleHeading({level:l}).run())return!1}else{var h=l.split("").pop();if(i!=null&&i["".concat(l,"Disabled")]||!r.can().chain().focus().toggleATitle({level:Number(h)}).run())return!1}if(typeof l=="number")r.chain().focus().toggleHeading({level:l}).run();else{var p=l.split("").pop();r.chain().focus().toggleATitle({level:Number(p)}).run()}n(!1)},className:P()("tide-dropdown-menu__item",{"tide-dropdown-menu__item--active":i==null?void 0:i["heading".concat(l,"IsActive")],"tide-dropdown-menu__item--disabled":i==null?void 0:i["heading".concat(l,"Disabled")]}),children:(0,o.jsxs)("div",{className:P()("tide-menu-head-row"),children:[(0,o.jsx)("span",{className:"tide-menu-head-row__title--level".concat(l),children:gt[l]||"".concat(l,"\u7EA7\u6807\u9898")}),typeof l=="number"&&(0,o.jsx)("span",{className:"tide-menu-head-row__span",children:"".concat(v.WD," + ").concat(v.Kw," + ").concat(l)})]})},l)})]})}),children:(0,o.jsxs)("div",{className:"tide-dropdown-trigger",onClick:function(){return n(!a)},children:[(0,o.jsx)("span",{className:"tide-dropdown-trigger__head-text",children:f()}),(0,o.jsx)(ct.KCe,{className:"tide-dropdown-trigger__head-icon"})]})})})},Be=function(t){var e=t.className,a=t.style,n=(0,v.W6)(function(){return{isActive:function(){return(0,I.zh)(s.state,"AWenHao")},disabled:function(){return!s.state.schema.nodes.AWenHao||!s.can().toggleWenHao()}}}),s=n.editor,r=n.statusMap;return(0,o.jsx)(v.o1,{className:e,children:(0,o.jsx)(v.u,{text:"\u6587\u53F7",children:(0,o.jsx)(mt,{onClick:function(){return s.chain().focus().toggleWenHao().run()},isActive:r==null?void 0:r.isActive,disabled:r==null?void 0:r.disabled,style:{width:48,justifyContent:"center",display:"flex",alignItems:"center"},children:"\u6587\u53F7"})})})},Ie=function(t){var e=t.editor,a=t.disabledMenu,n=a===void 0?!1:a,s=t.menuClassName,r=t.menuStyle,i=vt(),f=i.fullscreen,l=i.editable,c=(0,C.useMemo)(function(){if(!e)return null;var h=e.state.schema.nodes,p=h.AWenHao,x=h.ATail,T=h.ALink,y=h.ATitle,k=h.bulletList,m=h.orderedList,g=h.taskList,A=h.image,H=h.table,S=h.codeBlock,N=h.blockquote,B=h.horizontalRule,M=h.emoji,j=e.state.schema.marks,b=j.bold,O=j.italic,w=j.strike,$=j.link,Q=j.code;return[[e.menuEnableUndoRedo&&(0,o.jsx)(v.WP,{},"undo"),e.menuEnableUndoRedo&&(0,o.jsx)(v.Jw,{},"redo")],[y&&(0,o.jsx)(Oe,{},"ATitle"),x&&(0,o.jsx)(Ne,{},"ATail"),p&&(0,o.jsx)(Be,{},"AWenhao"),b&&(0,o.jsx)(v.d8,{},"bold"),O&&(0,o.jsx)(v.Tx,{},"italic"),w&&(0,o.jsx)(v.Re,{},"strike"),Q&&(0,o.jsx)(v.EK,{},"code")],[k&&(0,o.jsx)(v.DY,{},"bulletList"),m&&(0,o.jsx)(v.GS,{},"orderedList"),g&&(0,o.jsx)(v.ax,{},"taskList")],[$&&(0,o.jsx)(oe,{},"link"),A&&(0,o.jsx)(v.Ee,{},"image"),H&&(0,o.jsx)(v.iA,{},"table"),S&&(0,o.jsx)(v.dn,{},"codeBlock")],[N&&(0,o.jsx)(v.V6,{},"blockquote"),B&&(0,o.jsx)(v.bo,{},"horizontalRule"),M&&(0,o.jsx)(v.dy,{},"emoji")],[e.menuEnableFullscreen&&(0,o.jsx)(v.iT,{fullscreen:f,onFullscreenChange:function(J){e.setFullscreen(J)}},"fullscreen")]].map(function(F){return F.filter(Boolean)}).filter(function(F){return F.length>0}).map(function(F,J,we){return(0,o.jsxs)(C.Fragment,{children:[F,J<we.length-1&&(0,o.jsx)(v.uy,{})]},J)})},[e,l,f,e==null?void 0:e.menuEnableUndoRedo,e==null?void 0:e.menuEnableFullscreen]);return!l&&!(e!=null&&e.readOnlyShowMenu)?null:(0,o.jsx)(v.j_,{className:P()(s,{disabled:(e==null?void 0:e.readOnlyShowMenu)||n}),style:r,children:c})},xt=function(t){var e=t.editor,a=t.className,n=t.style,s=t.menuClassName,r=t.menuStyle,i=t.contentClassName,f=t.contentStyle;return e?(0,o.jsx)(He,{editor:e,style:n,className:a,children:(0,o.jsxs)(v.lv,{editor:e,children:[(0,o.jsx)(Ie,{editor:e,menuStyle:r,menuClassName:s}),(0,o.jsxs)(ht,{editor:e,contentStyle:f,contentClassName:i,children:[(0,o.jsx)(it.dC,{editor:e}),(0,o.jsx)(U.d6,{editor:e}),(0,o.jsx)(st.El,{editor:e}),(0,o.jsx)(v.OA,{editor:e})]})]})}):null};xt.displayName="EditorRender";var Pe=function(t,e){return(0,V.jE)(Se,t,e)},$e=["starterKitOpt","parseOptions","editorProps","mode","onChange","debug","height","value","onReady"],Fe=function(){var u=kt()(tt()().mark(function t(e,a){var n,s;return tt()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n="",s=new FileReader,s.onload=function(){n=s.result},s.readAsDataURL(e),console.log("file",e),i.abrupt("return",new Promise(function(f){var l=1,c=setInterval(function(){l++,a(l*10),l>=10&&(clearInterval(c),f(n))},300)}));case 6:case"end":return i.stop()}},t)}));return function(e,a){return u.apply(this,arguments)}}(),De=function(t){var e=t.starterKitOpt,a=t.parseOptions,n=t.editorProps,s=t.mode,r=s===void 0?"json":s,i=t.onChange,f=t.debug,l=t.height,c=l===void 0?500:l,h=t.value,p=t.onReady,x=_()(t,$e),T=C.useState(!1),y=R()(T,2),k=y[0],m=y[1],g=C.useState(),A=R()(g,2),H=A[0],S=A[1],N=Pe({extensions:[jt,Mt,St,he,re.configure(L()({link:!1,uploader:{image:{uploader:Fe}}},e))],onChange:function(M,j){var b;r==="json"?b=M:r==="md"?b=j.getMarkdown():b=j.getHTML(),S(b),i==null||i(b,j)},editorProps:n,parseOptions:a||{},onReady:function(M){f&&console.log("editor onReady",M),p==null||p(M),m(!0)}});return(0,C.useEffect)(function(){k&&H!==h&&(f&&console.log("editor setContent",h),S(h),N==null||N.setContent(h||""))},[h,k]),(0,o.jsx)("div",{className:"main",children:(0,o.jsx)(xt,L()({editor:N,style:{height:c}},x))})},We=De,ze=function(){var u=(0,C.useState)(),t=R()(u,2),e=t[0],a=t[1],n=(0,C.useState)("html"),s=R()(n,2),r=s[0],i=s[1],f=(0,C.useState)(),l=R()(f,2),c=l[0],h=l[1],p=(0,C.useState)(),x=R()(p,2),T=x[0],y=x[1],k=(0,C.useState)(),m=R()(k,2),g=m[0],A=m[1],H=(0,C.useState)(!1),S=R()(H,2),N=S[0],B=S[1],M=function(b,O){console.log("onChange",b,O),A(O.getHTML()),h(O.getMarkdown()),y(O.getJSON()),a(b)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(We,{mode:r,value:e,onChange:M}),(0,o.jsx)("div",{style:{marginTop:12},children:(0,o.jsx)("button",{onClick:function(){a("<p>123</p>")},children:"\u53EA\u8BFB\u6A21\u5F0F"})}),(0,o.jsxs)("div",{style:{marginTop:12},children:[(0,o.jsx)("button",{onClick:function(){i("html"),a("<p>123</p>")},children:"\u8D4B\u503Chtml"}),(0,o.jsx)("button",{onClick:function(){i("md"),a("! \u4F60\u597D")},children:"\u8D4B\u503Cmd"}),(0,o.jsx)("button",{onClick:function(){i("json"),a({type:"doc",content:[{type:"paragraph",attrs:{textAlign:"left",indent:0},content:[{type:"text",text:"\u963F\u8428\u8FBE\u963F\u8428\u5927\u5927\u548B\u6253\u6253\u7B97111"},{type:"text",marks:[{type:"link",attrs:{href:"\u963F\u8428\u5927\u5927",target:"_blank","data-id":123131321}}],text:"\u963F\u8428\u5927\u5927"}]}]})},children:"\u8D4B\u503Cjson"})]}),(0,o.jsx)("h3",{children:"jsonValue"}),(0,o.jsx)("div",{style:{marginTop:12},children:JSON.stringify(T)}),(0,o.jsx)("h3",{children:"htmlValue"}),(0,o.jsx)("div",{style:{marginTop:12},children:g}),(0,o.jsx)("h3",{children:"mdValue"}),(0,o.jsx)("div",{style:{marginTop:12},children:c})]})}}}]);
